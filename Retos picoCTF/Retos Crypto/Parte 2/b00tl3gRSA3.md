### b00tl3gRSA3

### Objetivos 
Why use p and q when I can use more? Connect with `nc jupiter.challenges.picoctf.org 51575`.

### Pistas
1. There's more prime factors than p and q, finding d is going to be different.

### Solución 

- nos conectamos al servidor y obtenemos el mensaje encriptado en RSA
``` bash
┌──(kali㉿kali)-[~/Retos]
└─$ nc jupiter.challenges.picoctf.org 51575
c: 3158529295799769563542753283778131487430463517638551081894285824784162634893363970508087046778047668809412553932005861504840053697466477071776548757416231873582912690779562402687643648512897365411285071602587434220774665215251057655648280008579316066856223610328678547617557835028908324082182876044857645904198730178956711108519548844201095202
n: 3279629130502541176900392519597895782050862993967108036509385429480464870077835313550946725330680888690324084624540074686233934156993817895306743405286746541462368966416883718249597396271588839748600085617843441385361894499937124544941999471822545979309469792876557210152860384274624178513667216219872173200377263814983902059862636006009858503
e: 65537

```

- sacamos el factor de n con ayuda de esta pagina:
https://www.alpertron.com.ar/ECM.HTM

- al factor le remplazamos los 'x' (signo de multiplicacion) por x (equis normal) con el remplazador de las notas.

- Hacemos un codigo en python para desencriptarlo el mensaje
``` python

from Crypto.Util.number import inverse, long_to_bytes
c = 14201397583466900396894819352110933057660345891370170110391797883297557142670597890365668163546567366620115535306963363033174746736954296925341048540728090323042590474296469453076352544602929367161101230253822459081751364763559031508852460051244430703437694629516412214186399511257778503939098679133413702242820037296744133282870988277449603334
n = 31143060939465583978067708277933657479329101970017768956725176073308814529675797572969373903269189321033100111770600169124106789447766992591223737792814886190818965943698172762821684069498294408459347551578879203706634895684858293540112684072337738073288292679298614459558052981402615047677170835136762158594890213481236648264661242174815776803
e = 65537

a = "31 143060 939465 583978 067708 277933 657479 329101 970017 768956 725176 073308 814529 675797 572969 373903 269189 321033 100111 770600 169124 106789 447766 992591 223737 792814 886190 818965 943698 172762 821684 069498 294408 459347 551578 879203 706634 895684 858293 540112 684072 337738 073288 292679 298614 459558 052981 402615 047677 170835 136762 158594 890213 481236 648264 661242 174815 776803 (344 digits) = 8707 121833 x 8878 966409 x 9117 936829 x 9443 947351 x 9455 831809 x 10029 695843 x 10281 930221 x 10616 623013 x 10657 763773 x 10938 432727 x 11245 924111 x 11823 364159 x 12481 105783 x 12574 736393 x 12642 374669 x 12878 707939 x 13106 530361 x 13286 835379 x 13592 783881 x 13734 144497 x 13773 371939 x 13869 077527 x 14031 214567 x 14052 324029 x 14198 449459 x 14259 894001 x 14824 570063 x 15838 757707 x 15888 589043 x 16115 083877 x 16469 818901 x 16504 780583 x 16769 732509 x 16790 422331".split("=")[1].replace(" ", "").split("x")

factors = []

for i in a:
	factors.append(int(i))
phi = 1;
for i in factors:
	phi *= (i-1)

d = inverse(e, phi)

print(long_to_bytes(pow(c, d, n)).decode())
```


``` bash
┌──(kali㉿kali)-[~/Retos]
└─$ python3 script.py 

picoCTF{too_many_fact0rs_0731311}
```


picoCTF{too_many_fact0rs_0731311}

### Notas adicionales:

librerias de python necesarias:
- pycryptodome
- gmpy2 


c - texto cifrado
m - mensaje texto plano
p - primo 1
q - primo 2
n - modulo
tn- totient n (euler)
e - exponente (llave publica)
d - llave privada

n = p * q
tn = (p-1)*(q-1)
d = e mod inv tn / inverse(e, tn)

encriptar	: c = m^e mod n / pow(m,e,n)
desencriptar	: m = c^e mod n / pow(c,d,n)


### Referencias:
RSA [tutorial](https://en.wikipedia.org/wiki/RSA_(cryptosystem))